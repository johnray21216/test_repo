this is a modification of kent.